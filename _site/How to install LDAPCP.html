<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>LDAPCP</title>
    <meta name="description" content="Most popular, free and open source claims provider for SharePoint 2013 and 2016"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=80fc5cece8916116610e59cb7cd09620845d0579">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">LDAPCP</h1>
      <h2 class="project-tagline">Most popular, free and open source claims provider for SharePoint 2013 and 2016</h2>
      
        <a href="http://github.com/Yvand/LDAPCP" class="btn">View on GitHub</a>
      
      
        <a href="http://github.com/Yvand/LDAPCP/zipball/gh-pages" class="btn">Download .zip</a>
        <a href="http://github.com/Yvand/LDAPCP/tarball/gh-pages" class="btn">Download .tar.gz</a>
      
    </section>

    <section class="main-content">
      <h1 id="how-to-install-ldapcp">How to install LDAPCP</h1>
<ul>
  <li>Download <a href="https://github.com/Yvand/LDAPCP/releases">latest release of LDAPCP.wsp</a>.</li>
  <li>Install and deploy the solution (that will automatically activate the “LDAPCP” farm-scoped feature):
    <div class="language-powershell highlighter-rouge"><pre class="highlight"><code>Add-SPSolution -LiteralPath <span class="s2">"PATH TO WSP FILE"</span>
Install-SPSolution -Identity <span class="s2">"LDAPCP.wsp"</span> -GACDeployment
</code></pre>
    </div>
  </li>
  <li>At this point claim provider is inactive and it must be associated to an SPTrustedIdentityTokenIssuer to work:
    <div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="nv">$trust</span> <span class="o">=</span> Get-SPTrustedIdentityTokenIssuer <span class="s2">"SPTRUST NAME"</span>
<span class="nv">$trust</span>.ClaimProviderName <span class="o">=</span> <span class="s2">"LDAPCP"</span>
<span class="nv">$trust</span>.Update<span class="o">()</span>
</code></pre>
    </div>
  </li>
</ul>

<h2 id="important---limitations">Important - Limitations</h2>
<p>Due to limitations of SharePoint API, do not associate LDAPCP with more than 1 SPTrustedIdentityTokenIssuer. Developers can bypass this limitation by inheriting LDAPCP to create new claims providers (with different names). Read “Developers section” below for further information.</p>

<p>You must manually deploy ldapcp.dll on SharePoint servers that do not have SharePoint service “Microsoft SharePoint Foundation Web Application” started. You can use this PowerShell script:</p>
<div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>System.Reflection.Assembly]::Load<span class="o">(</span><span class="s2">"System.EnterpriseServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="o">)</span>
<span class="nv">$publish</span> <span class="o">=</span> <span class="nb">New-Object </span>System.EnterpriseServices.Internal.Publish
<span class="nv">$publish</span>.GacInstall<span class="o">(</span><span class="s2">"C:</span><span class="se">\D</span><span class="s2">ata</span><span class="se">\D</span><span class="s2">ev</span><span class="se">\l</span><span class="s2">dapcp.dll"</span><span class="o">)</span>
</code></pre>
</div>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/Yvand/LDAPCP">LDAPCP</a> is maintained by <a href="http://github.com/Yvand">Yvand</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
